RewriteEngine On

# Landing Page - Redirect root to main page
RewriteRule ^$ index.php [L]

# Client Routes
RewriteRule ^client/login/?$ client/login.php [L]
RewriteRule ^client/dashboard/?$ client/dashboard.php [L]

# Admin Routes
RewriteRule ^admin/login/?$ admin/login.php [L]
RewriteRule ^admin/dashboard/?$ admin/dashboard.php [L]
RewriteRule ^admin/tenants/?$ admin/tenants.php [L]

# API Routes
RewriteRule ^api/auth/(.*)$ api/auth.php/$1 [QSA,L]
RewriteRule ^api/client-auth/(.*)$ api/client-auth.php/$1 [QSA,L]
RewriteRule ^api/client-requests/(.*)$ api/client-requests.php/$1 [QSA,L]
RewriteRule ^api/client-requests$ api/client-requests.php [QSA,L]
RewriteRule ^api/client-tenants/(.*)$ api/client-tenants.php/$1 [QSA,L]
RewriteRule ^api/client-analytics$ api/client-analytics.php [QSA,L]
RewriteRule ^api/tenants/(.*)$ api/tenants.php/$1 [QSA,L]
RewriteRule ^api/tenants$ api/tenants.php [QSA,L]
RewriteRule ^api/tmdb/(.*)$ api/tmdb.php/$1 [QSA,L]
RewriteRule ^api/tenant-requests$ api/tenant-requests.php [QSA,L]

# Tenant Routes - Must come after API routes
RewriteCond %{REQUEST_URI} !^/(api|admin|client|assets|vendor)/
RewriteRule ^([a-zA-Z0-9\-_]+)/?$ public/tenant_router.php [QSA,L]
RewriteCond %{REQUEST_URI} !^/(api|admin|client|assets|vendor)/
RewriteRule ^([a-zA-Z0-9\-_]+)/(.*)$ public/tenant_router.php [QSA,L]

# Security Headers
Header always set X-Content-Type-Options nosniff
Header always set X-Frame-Options DENY
Header always set X-XSS-Protection "1; mode=block"

# Prevent access to sensitive files
<Files "composer.json">
    Order allow,deny
    Deny from all
</Files>

<FilesMatch "\.env">
    Order allow,deny
    Deny from all
</FilesMatch>

Options -Indexes